public String waitForWindow(int timeout) {
  try {
    Thread.sleep(timeout);
  } catch (InterruptedException e) {
    e.printStackTrace();
  }
  Set<String> whNow = driver.getWindowHandles();
  Set<String> whThen = (Set<String>) vars.get("window_handles");
  if (whNow.size() > whThen.size()) {
    whNow.removeAll(whThen);
  }
  return whNow.iterator().next();
}
